<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>用户和用户组管理 | Riku&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="知识整理">
    <meta name="keywords" content="知识整理">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.2b4a33db.css" as="style"><link rel="preload" href="/assets/js/app.8a3ae5f1.js" as="script"><link rel="preload" href="/assets/js/2.fbbb7b81.js" as="script"><link rel="preload" href="/assets/js/26.e377677c.js" as="script"><link rel="prefetch" href="/assets/js/10.865824eb.js"><link rel="prefetch" href="/assets/js/11.807323d2.js"><link rel="prefetch" href="/assets/js/12.0479603f.js"><link rel="prefetch" href="/assets/js/13.e8f672b6.js"><link rel="prefetch" href="/assets/js/14.0718d54e.js"><link rel="prefetch" href="/assets/js/15.adb84ad6.js"><link rel="prefetch" href="/assets/js/16.7469cb02.js"><link rel="prefetch" href="/assets/js/17.51a1ee74.js"><link rel="prefetch" href="/assets/js/18.274aa6b1.js"><link rel="prefetch" href="/assets/js/19.2fd786e6.js"><link rel="prefetch" href="/assets/js/20.ea598d55.js"><link rel="prefetch" href="/assets/js/21.8ed232c6.js"><link rel="prefetch" href="/assets/js/22.10fa5a9d.js"><link rel="prefetch" href="/assets/js/23.1f843d26.js"><link rel="prefetch" href="/assets/js/24.0e18e95e.js"><link rel="prefetch" href="/assets/js/25.ca541120.js"><link rel="prefetch" href="/assets/js/27.16960daa.js"><link rel="prefetch" href="/assets/js/3.9119fdf5.js"><link rel="prefetch" href="/assets/js/4.6bc50a21.js"><link rel="prefetch" href="/assets/js/5.0ff9a6d8.js"><link rel="prefetch" href="/assets/js/6.b402d03c.js"><link rel="prefetch" href="/assets/js/7.92659bbb.js"><link rel="prefetch" href="/assets/js/8.bee9f62a.js"><link rel="prefetch" href="/assets/js/9.acf4edca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2b4a33db.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://gitee.com/chobits01/image/raw/master/image/sun.png" alt="Riku's blog" class="logo"> <span class="site-name can-hide">Riku's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/archives/" class="nav-link">Timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">Categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://gitee.com/chobits01/image/raw/master/image/riku.jpg"> <div class="blogger-info"><h3>Riku</h3> <span>文学少年!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/archives/" class="nav-link">Timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">Categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">Tags</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-33863c7e><div class="articleInfo" data-v-33863c7e><ul class="breadcrumbs" data-v-33863c7e><li data-v-33863c7e><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-33863c7e></a></li> <li data-v-33863c7e><a href="/categories/?category=lunux%E5%9F%BA%E7%A1%80" title="分类" data-v-33863c7e>lunux基础</a></li> <!----> <!----></ul> <div class="info" data-v-33863c7e><div title="作者" class="author iconfont icon-touxiang" data-v-33863c7e><a href="https://github.com/mowanqing" target="_blank" title="作者" class="beLink" data-v-33863c7e>Riku</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-33863c7e><a href="javascript:;" data-v-33863c7e>2021-03-29</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          用户和用户组管理
        </h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="用户配置文件"><a href="#用户配置文件" class="header-anchor">#</a> 用户配置文件</h2> <p>用户信息文件:<strong>/etc/passwd</strong></p> <p>影子文件:<strong>/etc/shadow</strong></p> <p>组信息文件:<strong>/etc/group</strong>和组密码文件:<strong>/etc/gshadow</strong></p> <ol><li>/etc/passwd
<ol><li>第一字段:用户名称</li> <li>第二字段:密码标志</li> <li>第三字段:UID(用户ID)
<ol><li>0:超级用户</li> <li>1-499:系统用户(伪用户)</li> <li>500-65535:普通用户</li></ol></li> <li>第四字段GID(用户初始组ID)</li> <li>第五字段用户说明</li> <li>第六字段家目录
<ol><li>普通用户:/home/用户名/</li> <li>超级用户:/root</li></ol></li> <li>第7字段:登录之后的Shell</li></ol></li></ol> <h3 id="初始组和附加组"><a href="#初始组和附加组" class="header-anchor">#</a> 初始组和附加组</h3> <p>初始组:用户一登录就有这个用户组的相关权限</p> <p>附加组:用户可以加入多个其他的用户组,并拥有这些组的权限,附加组可以有多个.</p> <ol start="2"><li>/etc/shadow
<ol><li>第一字段:用户名称</li> <li>第二字段:加密密码
<ol><li>加密算法升级为SHA512散列加密算法</li> <li>如果密码位是!!或*代表没有密码,不能登录</li></ol></li> <li>第三字段:密码最后一次修改日期
<ol><li>1970年1月1日作为标准时间,没过一天事件戳加1</li></ol></li> <li>第四字段:两次密码的修改间隔时间</li> <li>第五字段密码有效期</li> <li>第六字段:密码修改到期前的警告天数(和第五子段相比)</li> <li>第七字段:密码过期后的宽限天数(和第5字段相比)
<ol><li>0:代表密码过期后立即失效</li> <li>-1:则代表密码永远不会失效</li></ol></li> <li>第8字段:账号失效时间
<ol><li>要用时间戳表示</li></ol></li> <li>第9字段:保留</li></ol></li></ol> <p>把时间戳换算为日期</p> <p><code>date -d &quot;1970-01-01 16066 days&quot;</code></p> <p>把日期换算为时间戳</p> <p><code>echo $(($(date --date=&quot;2021/02/09&quot; +%s)/86400+1))</code></p> <h3 id="组信息文件-etc-group和组密码文件-etc-gshadow"><a href="#组信息文件-etc-group和组密码文件-etc-gshadow" class="header-anchor">#</a> 组信息文件/etc/group和组密码文件/etc/gshadow</h3> <ol><li><p>组信息文件/etc/group</p> <ol><li>组名</li> <li>组密码标志</li> <li>GID</li> <li>组中附加用户</li></ol> <p>2.组密码文件/etc/gshadow</p> <ol><li>组名</li> <li>组密码</li> <li>组管理员用户名</li> <li>组中附加用户</li></ol></li></ol> <h2 id="用户管理相关文件"><a href="#用户管理相关文件" class="header-anchor">#</a> 用户管理相关文件</h2> <ol><li><p>用户的家目录</p> <ol><li>普通用户:/home/用户名,所有者和所有组都是此用户,权限是700</li> <li>超级用户:/root,所有者和所属组都是root用户,权限是550</li></ol></li> <li><p>用户的邮箱</p> <ol><li>/var/spool/mail/用户名</li></ol></li> <li><p>用户模板目录</p> <ol><li>/etc/skel</li></ol></li></ol> <h2 id="用户管理命令"><a href="#用户管理命令" class="header-anchor">#</a> 用户管理命令</h2> <h3 id="用户"><a href="#用户" class="header-anchor">#</a> 用户</h3> <ol><li>用户添加命令 <code>useradd</code> <ol><li>-u UID:手工指定用户的UID号</li> <li>-d 家目录:手工指定用户的家目录</li> <li>-c 用户说明:手工指定用户的说明</li> <li>-g 组名:手工指定用户的初始组</li> <li>-G 组名: 指定用户的附加组</li> <li>-s shell:手工指定用户的登录shell 默认是/bin/bash</li> <li>/etc/login.defs 可以改密码有效期</li></ol></li> <li>修改用户密码 <code>passwd</code> <ol><li>-s 查询用户密码的密码状态,仅root用户可用</li> <li>-l 暂时锁定用户,仅root用户可用</li> <li>-u解锁用户,仅root用户可用</li> <li>--stdin 可以通过管道符输出的数据作为用户的密码
<ol><li><code>echo &quot;123&quot; |passwd --stdin userName</code></li></ol></li></ol></li> <li>修改用户信息 <code>usermod</code> <ol><li>-u UID:手工指定用户的UID号</li> <li>-c 用户说明:手工指定用户的说明</li> <li>-G 组名: 指定用户的附加组
<ol><li><code>usermod -G root userName</code></li></ol></li> <li>-L: 临时锁定用户(Lock)</li> <li>-U:解锁用户锁定(Unlock)</li></ol></li> <li>修改用户密码状态  <code>chage</code> <ol><li>-l 列出用户的详细密码状态</li> <li>-d:日期: 修改密码最后一次更改日期 3字段
<ol><li><code>change -d 0 userName</code></li></ol></li> <li>-m天数:两次密码修改间隔 4字段</li> <li>-M 天数:密码有效期 5字段</li> <li>-W 天数:密码过期前警告天数 6字段</li> <li>-I 天数:密码过期后宽限天数 7字段</li> <li>-E 日期:账号失效时间 8字段</li></ol></li> <li>删除用户 <code>userdel</code> <ol><li>-r 删除用户的同时删除用户家目录</li></ol></li> <li>用户切换命令 <code>su</code> <ol><li>-:选项只使用&quot;-&quot;代表连带用户的环境变量一起切换</li> <li>-c命令:仅执行一次命令,而不切换用户身份
<ol><li><code>su - root -c &quot;useradd user3&quot;</code></li></ol></li></ol></li></ol> <h3 id="用户组"><a href="#用户组" class="header-anchor">#</a> 用户组</h3> <ol><li>添加用户组 <code>groupadd 组名</code> <ol><li>-g GID: 指定组ID</li></ol></li> <li>修改用户组:<code>groupmod 组名</code> <ol><li>-g GID: 修改组</li> <li>-n 新组名: 修改组名
<ol><li><code>groupmod -n testgrp group1</code></li></ol></li></ol></li> <li>删除用户组
<ol><li>groupdel 组名
<ol><li>这个组不允许有初始组存在,不然无法删除u该组</li></ol></li></ol></li> <li>把用户添加入组或从组中删除
<ol><li>gpasswd 选项 组名
<ol><li>-a 用户名: 把用户加入组
<ol><li><code>gpasswd -a user1 root</code></li></ol></li> <li>-d 用户名: 把用户从组中删除
<ol><li><code>gpasswd -d user1 root</code></li></ol></li></ol></li></ol></li></ol></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">3/29/2021, 4:48:26 PM</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:riku7032@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/mowanqing" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.zhihu.com/people/lu-xiao-you-44-77" title="zhihu" target="_blank" class="iconfont icon-zhihu"></a></div> 
  Powered by 
  <a href="https://vuepress.vuejs.org/zh/" target="_blank" title="Vuepress">Vuepress</a> 
    | Copyright © 2020-2021
    <span>Riku | <a href="https://github.com/vuejs/vuepress/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8a3ae5f1.js" defer></script><script src="/assets/js/2.fbbb7b81.js" defer></script><script src="/assets/js/26.e377677c.js" defer></script>
  </body>
</html>